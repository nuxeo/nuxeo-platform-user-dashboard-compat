<?xml version="1.0"?>

<component name="org.nuxeo.ecm.webapp.user.dashboard.compat.theme">

  <require>org.nuxeo.theme.core</require>
  <require>org.nuxeo.theme.fragments</require>
  <require>org.nuxeo.theme.html</require>
  <require>org.nuxeo.theme.jsf</require>

  <!-- require default nuxeo theme -->
  <require>org.nuxeo.theme.nuxeo.default</require>

  <!-- perspectives -->
  <extension target="org.nuxeo.theme.services.ThemeService"
    point="perspectives">

    <perspective name="multiple_domains">
      <title>Perspective for multiple domains</title>
    </perspective>

  </extension>

  <!--  themes -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="themes">

    <theme>
      <src>themes/theme-user-dashboard-compat.xml</src>
    </theme>

  </extension>

  <!-- views -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="views">

    <view name="Nuxeo DM logo (DashboardCompat Galaxy Theme)"
      template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/logo_DM_galaxy.xhtml</template>
    </view>

    <view name="User services (DashboardCompat Galaxy theme)"
      template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/user_services_galaxy.xhtml</template>
      <resource>screen.css</resource>
    </view>

    <view name="nuxeo5 dashboard domain selection"
      template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/dashboard_domain_selection.xhtml</template>
    </view>

    <view name="Nuxeo DM footer (DashboardCompat Galaxy Theme)"
      template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/footer_galaxy.xhtml</template>
    </view>

    <view name="nuxeo5 user tasks" template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of tasks of the current user -->
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/dashboard_user_tasks.xhtml</template>
      <resource>foldable-box.js</resource>
    </view>

    <view name="nuxeo5 user processes" template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of processes of the current user (i.e : the ones where he is initiator -->
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/dashboard_user_processes.xhtml</template>
      <resource>foldable-box.js</resource>
    </view>

    <view name="nuxeo5 user workspaces" template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of tasks of workspaces the current user can see -->
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/dashboard_user_workspaces.xhtml</template>
      <resource>foldable-box.js</resource>
    </view>

    <view name="nuxeo5 user sites" template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of sites the current user can see -->
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/dashboard_user_sites.xhtml</template>
      <resource>foldable-box.js</resource>
    </view>

    <view name="nuxeo5 user documents" template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of documents the current user has been working on recently -->
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/dashboard_user_documents.xhtml</template>
      <resource>foldable-box.js</resource>
    </view>

    <view name="nuxeo5 user deleted documents" template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of documents the current user has been working on recently -->
      <format-type>widget</format-type>
      <template>
        dashboardcompat/incl/dashboard_user_deleted_documents.xhtml
      </template>
      <resource>foldable-box.js</resource>
    </view>

    <view name="nuxeo5 last documents" template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of documents that have been modified recently -->
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/dashboard_last_documents.xhtml</template>
      <resource>foldable-box.js</resource>
    </view>

    <view name="nuxeo5 last published documents"
      template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of documents that have been published recently -->
      <format-type>widget</format-type>
      <template>
        dashboardcompat/incl/dashboard_last_published_documents.xhtml
      </template>
      <resource>foldable-box.js</resource>
    </view>

    <view name="nuxeo5 user sections" template-engine="jsf-facelets">
      <!-- Fragment to be displayed as part of the dashboard to display the
        list of documents the current user has been working on recently -->
      <format-type>widget</format-type>
      <template>dashboardcompat/incl/dashboard_user_sections.xhtml</template>
      <resource>foldable-box.js</resource>
    </view>

  </extension>

  <!-- application settings -->
  <extension target="org.nuxeo.theme.services.ThemeService"
    point="applications">

    <application root="${org.nuxeo.ecm.contextPath}"
      template-engine="jsf-facelets">

      <view id="/user_dashboard.xhtml">
        <theme>userDashboardCompat/user_dashboard</theme>
      </view>

    </application>

  </extension>

  <!-- negotiation strategy for nuxeo5-->
  <extension target="org.nuxeo.theme.services.ThemeService"
    point="negotiations">

    <negotiation object="perspective" strategy="nuxeo5">
      <scheme>
        org.nuxeo.theme.jsf.negotiation.perspective.RequestParameter
      </scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.perspective.CookieValue</scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.perspective.ViewId</scheme>
      <!-- local perspective (specific to nuxeo5) -->
      <scheme>org.nuxeo.ecm.webapp.theme.negotiation.LocalPerspective</scheme>
      <!-- multiple domaines perspective (specific to nuxeo5) -->
      <scheme>
        org.nuxeo.ecm.webapp.dashboard.MultipleDomainsPerspectiveNegotiator
      </scheme>
      <scheme>
        org.nuxeo.theme.jsf.negotiation.perspective.DefaultPerspective
      </scheme>
    </negotiation>

  </extension>

  <!-- Styles presets -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="presets">

    <palette name="DashboardCompat Galaxy borders"
      src="themes/palettes/galaxy-borders.properties" category="border" />
    <palette name="DashboardCompat Galaxy backgrounds"
      src="themes/palettes/galaxy-backgrounds.properties" category="background" />
    <palette name="DashboardCompat Galaxy fonts"
      src="themes/palettes/galaxy-fonts.properties" category="font" />
    <palette name="DashboardCompat Galaxy colors"
      src="themes/palettes/galaxy-colors.properties" category="color" />

  </extension>


</component>
